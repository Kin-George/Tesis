# Pobreza y crecimiento en Barranquilla A.M.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
library(dplyr)
library(ggplot2)
library(ggthemes)
library(ggpubr)

factor<-450
grafico_base = pobreza_y_crecimiento %>%
  ggplot(aes(x=año))+
  geom_line(aes(y=Pobreza, color="Pobreza"), linewidth=1.25, alpha=0.8)+
  geom_line(aes(y=`Pobreza extrema`, color="Pobreza extrema"), linewidth=1.25, alpha = 0.8)+
  geom_line(aes(y=PIB/factor, color="PIB"), linewidth=1.25, alpha=0.8,linetype=5)+
  scale_y_continuous(sec.axis=sec_axis(trans=~.*factor,name="PIB per cápita (miles de pesos)"))+
  scale_color_discrete("")+
  theme_bw()+
  labs(subtitle="Barranquilla A.M. 2011 - 2021",
       title="Evolución de la pobreza monetaria y del PIB",
       x = "Año",
       y = "Pobreza (%)",
       caption="Fuente: Pobreza Monetaria - Cuentas Nacionales, DANE (2021)"
  )+
  scale_x_continuous(breaks = c(2011,2013,2016,2019,2021))+
  theme(legend.title=element_text(color="black",size=12,face="bold"),
        plot.subtitle=element_text(color="black",size=10),
        axis.title.x=element_text(color="black",size=12,face="bold"),
        axis.title.y=element_text(color="black",size=12,face="bold"),
        plot.background = element_rect(fill="#F0F1EB"),
        legend.key=element_rect(fill="#F0F1EB"),
        legend.background = element_rect(fill="#F0F1EB"),
        plot.caption.position="plot",
        plot.caption=element_text(color="black",size=12,hjust=1),
        plot.title = element_text(color="black",size=12,face="bold"),
        legend.position = "bottom")

library(gifski)
library(gganimate)
grafico_animado = grafico_base+
  transition_reveal(año)
animate(grafico_animado,end_pause=60)

```

# Comparación con otras ciudades
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
Segundo_grafico %>%
  mutate(Segundo_grafico,isBarranquilla = Ciudad=="Barranquilla A.M.") %>%
  ggplot(aes(x=Año, y=Pobreza, color=Ciudad))+
  geom_line(aes(linetype=isBarranquilla),linewidth=1.25, alpha=0.8)+
  theme_bw()+
  scale_x_continuous(breaks = c(2011,2013,2016,2019,2021))+
  labs(title="Evolución de la pobreza",
       subtitle="Pobreza monetaria de las principales ciudades 2011 - 2021",
       x="Años",
       y="Pobreza (%)",
       tag="",
       color="Ciudad",
       caption="Fuente: Pobreza monetaria - DANE (2021)")+
  theme(axis.title=element_text(),
        legend.title=element_text(color="black",size=10,face="bold"),
        plot.subtitle=element_text(color="black",size=10,face="bold"),
        axis.title.x=element_text(color="black",size=12,face="bold"),
        axis.title.y=element_text(color="black",size=12,face="bold"),
        plot.tag.position="topright",
        plot.background = element_rect(fill="#F0F1EB"),
        legend.key=element_rect(fill="#F0F1EB"),
        legend.background = element_rect(fill="#F0F1EB"),
        legend.text=element_text(size=10),plot.caption.position="plot",plot.caption=element_text(color="black",size=12,hjust=0),legend.position="bottom")+
  scale_color_brewer(palette="Set2")+
  scale_linetype_manual(values=c("dashed","solid"),guide="none")



```

# Evolución del PIB - Barranquilla
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
Tercer_grafico %>%
  mutate(Tercer_grafico,isBarranquilla = Ciudad=="Barranquilla A.M.") %>%
  ggplot(aes(x=Año, y=Indice, color=Ciudad))+
  geom_line(aes(linetype=isBarranquilla),linewidth=1.25, alpha=0.8)+
  theme_bw()+
  scale_x_continuous(breaks = c(2010,2013,2016,2019,2021))+
  labs(title="Índice de la evolución del PIB (Año base = 2010)",
       subtitle="Como ha crecido el PIB per cápita en las principales ciudades?",
       x="Años",
       y="Var. porcentual (%)",
       tag="",
       color="Ciudad",
       caption="Fuente: Cálculos del autor con base en DANE (2021)")+
  theme(plot.tag.position="topright",
        legend.title=element_text(color="black",size=10,face="bold"),
        plot.subtitle=element_text(color="grey",size=10,face="bold"),
        axis.title.x=element_text(color="black",size=12,face="bold"),
        axis.title.y=element_text(color="black",size=12,face="bold"),
        plot.background = element_rect(fill="#F0F1EB"),
        legend.key=element_rect(fill="#F0F1EB"),
        legend.background = element_rect(fill="#F0F1EB"),
        axis.title=element_text(),
        legend.text=element_text(size=10),plot.caption.position="plot",plot.caption=element_text(color="black",size=12,hjust=0),legend.position="bottom")+
  scale_color_brewer(palette="Set2")+
  scale_linetype_manual(values=c("dashed","solid"),guide="none")

```


# evolucion principales ciudades
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
factor2=9000
grafico_base4 = PIB_Barranquilla %>%
  ggplot(aes(x=Año))+
  geom_line(aes(y=Barranquilla/factor2,color="Barranquilla A.M."), linewidth=1.25, alpha = 0.8, linetype=5)+
  geom_line(aes(y=Bogotá/factor2, color="Bogotá"), linewidth=1.25, alpha = 0.8, linetype=5)+
  geom_line(aes(y=Bucaramanga/factor2, color="Bucaramanga A.M."), linewidth=1.25, alpha=0.8,linetype=5)+
  geom_line(aes(y=Cali/factor2, color="Calí A.M."), linewidth=1.25,alpha=0.8,linetype=5)+
  geom_line(aes(y=Cartagena/factor2, color="Cartagena"),linewidth=1.25,alpha=0.8,linetype=5)+
  geom_line(aes(y=Medellin/factor2,color="Medellin A.M."), linewidth=1.25,alpha=0.8,linetype=5)+
  geom_line(aes(y=Nacional/factor2, color="Nacional"),linewidth=1.25,alpha=0.8,linetype=5)+
  theme_bw()+
  scale_color_discrete("")+
  labs(
    title="Evolución del PIB",
    subtitle="Como ha crecido el PIB per cápita en las principales ciudades?",
    x="Año",
    y="PIB per cápita (miles de pesos)",
    caption="Fuente: Elaboración propia con base en Cuentas Nacionales, DANE (2021)"
  )+
  scale_x_continuous(breaks = c(2010,2013,2016,2019,2021))+
  theme(plot.tag.position="topright",
        legend.title=element_text(color="black",size=10,face="bold"),
        plot.subtitle=element_text(color="black",size=10,face="bold"),
        axis.title.x=element_text(color="black",size=12,face="bold"),
        axis.title.y=element_text(color="black",size=12,face="bold"),
        plot.background = element_rect(fill="#F0F1EB"),
        legend.key=element_rect(fill="#F0F1EB"),
        legend.background = element_rect(fill="#F0F1EB"),
        axis.title=element_text(),
        legend.text=element_text(size=10),plot.caption.position="plot",plot.caption=element_text(color="black",size=12,hjust=0),legend.position="bottom")
  

library(gganimate)
grafico_animado3 = grafico_base4+
  transition_reveal(Año)
animate(grafico_animado3,end_pause = 60)
```

