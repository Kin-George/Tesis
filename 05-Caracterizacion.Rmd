# Pobreza y crecimiento en Barranquilla A.M.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
library(ggplot2)
library(ggthemes)
library(dplyr)
factor<-450
factor<-450
grafico_base = pobreza_y_crecimiento %>%
  ggplot(aes(x=año))+
  geom_line(aes(y=Pobreza, color="Pobreza"), linewidth=1.5, alpha=0.8)+
  geom_line(aes(y=`Pobreza extrema`, color="Pobreza extrema"), linewidth=1.5, alpha = 0.8)+
  geom_line(aes(y=PIB/factor, color="PIB"), linewidth=1.5, alpha=0.8)+
  scale_y_continuous(sec.axis=sec_axis(trans=~.*factor,name="PIB per capita"))+
  scale_color_discrete("")+
  labs(subtitle="Evolución de la pobreza monetaria y del PIB",
       x = "Año",
       tag="Figura 1",
       caption="Fuente: DANE (2022)")+
  theme_minimal()+
  theme(plot.tag.position="topleft",plot.caption.position="plot",plot.caption=element_text(hjust=0),legend.position = "bottom")

library(gifski)
grafico_animado = grafico_base+
  transition_reveal(año)
animate(grafico_animado,end_pause=60)

```

# Comparación con otras ciudades
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
library(dplyr)
library(ggplot2)
Segundo_grafico %>%
  mutate(Segundo_grafico,isBarranquilla = Ciudad=="Barranquilla A.M.") %>%
  ggplot(aes(x=Año, y=Pobreza, color=Ciudad))+
  geom_line(aes(linetype=isBarranquilla),size=1.5, alpha=0.8)+
  theme_minimal()+
  labs(title="Evolución de la pobreza",
       subtitle="Pobreza monetaria de las principales ciudades",
       x="Años",
       y="Pobreza",
       tag="Figura 2",
       color="Ciudad",
       caption="Fuente: DANE (2022)")+
  theme(axis.title=element_text(),
        legend.text=element_text(size=10),plot.caption.position="plot",plot.caption=element_text(hjust=0),legend.position="bottom")+
  scale_color_brewer(palette="Set2")+
  scale_linetype_manual(values=c("dashed","solid"),guide="none")



```

# Evolución del PIB - Barranquilla
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
#Barranquilla 
grafico_base3 = PIB_Barranquilla %>%
  ggplot(aes(x=Año))+
  geom_line(aes(y=Barranquilla, color="Barranquilla"), size=1.5, alpha=0.8)+
  theme_minimal()+
  labs(title="Evolución del PIB per capita",
       y="",
       subtitle="Barranquilla A.M.",
       tag="Figura 3",
       color="",
       caption="Fuente: cálculos del autor con base en DANE (2022)")+
  theme(axis.title=element_text(),
        legend.text=element_text(size=10),plot.caption.position="plot",plot.caption=element_text(hjust=0),legend.position="none")
grafico_base3
```


# evolucion principales ciudades
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
factor2=9
grafico_base4 = PIB_Barranquilla %>%
  ggplot(aes(x=Año))+
  geom_line(aes(y=Barranquilla/factor2, color="Barranquilla"), size=1.5, alpha=0.8)+
  geom_line(aes(y=Bogotá/factor2, color="Bogotá"), size=1.5, alpha=0.8)+
  geom_line(aes(y=Bucaramanga/factor2, color="Bucaramanga"), size=1.5, alpha=0.8)+
  geom_line(aes(y=Cali/factor2, color="Cali"), size=1.5, alpha=0.8)+
  geom_line(aes(y=Cartagena/factor2, color="Cartagena"), size=1.5, alpha=0.8)+
  geom_line(aes(y=Medellin/factor2, color="Medellin"), size=1.5, alpha=0.8)+
  geom_line(aes(y=Nacional/factor2, color="Nacional"), size=1.5, alpha=0.8)+
  theme_minimal()+
  labs(title="Evolución del PIB per capita",
       y="",
       subtitle="Barranquilla A.M.",
       tag="Figura 4",
       color="Ciudad",
       caption="Fuente: Cálculos del autor con base en DANE (2022)")+
  theme(axis.title=element_text(),
        legend.text=element_text(size=10),plot.caption.position="plot",plot.caption=element_text(hjust=0),legend.position="bottom")

library(gganimate)
grafico_animado3 = grafico_base4+
  transition_reveal(Año)
animate(grafico_animado3,end_pause = 60)
```

